<?xml version="1.0" encoding="UTF-8"?>


<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="com.pet.sns.model.dao.PostDaoMgr">
	<select id="selectone" parameterType="int" resultType="post">
		select
		pnum,unum,title,img,contents,likes,hits,comments,date,privacy
		from post
		where pnum=#{pnum}
	</select>
	<select id="selectall" resultType="post">
		select
		pnum,unum,title,img,contents,likes,hits,comments,date,privacy
		from post
	</select>
	<select id="selectmine" parameterType="int" resultType="post">
		select
		pnum,unum,title,img,contents,likes,hits,comments,date,privacy
		from post
		where unum = #{unum}
	</select>

	<insert id="insert" parameterType="post">
		insert into
		post(unum,title,img,contents,date)
		values
		(#{unum},#{title},#{img},#{contents},sysdate())
	</insert>

	<update id="update" parameterType="post">
		update post set title =
		#{title},
		contents =#{contents},
		privacy = #{privacy},
		img = {#img}
		where
		pnum =#{pnum}
	</update>

	<delete id="delete" parameterType="int">
		delete from post where pnum =
		#{pnum}
	</delete>

	<update id="hitup" parameterType="int">
		update post set hits = hits+1
		where pnum = #{pnum}
	</update>

	<!-- tag -->

	<insert id="inserttag" parameterType="string">
		insert into tag (word)
		values (#{word})
	</insert>

	<select id="selecttnum" parameterType="string" resultType="int">
		select tnum from tag where word =#{word}
	</select>
	<select id="selecttag" parameterType="int" resultType="string">
		select
		word from tag where tnum in
		(select tagnum from post_tag
		where postnum =
		#{pnum})
	</select>
	<delete id="deletetag" parameterType="int">
		delete from post_tag where
		postnum = #{pnum}
	</delete>
	<select id="tagsearch" parameterType="string" resultType="int">
		select
		postnum from post_tag where tagnum =(select tnum from tag where word
		=#{word});
	</select>

	<!-- post_tag -->
	<insert id="posttag" parameterType="tag">
		insert into post_tag
		(postnum, tagnum) values (#{pnum}, #{tnum});
	</insert>

</mapper>














